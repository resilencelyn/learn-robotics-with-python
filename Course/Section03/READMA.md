# 第3次任务 关节空间线性轨迹规划

## 1. 题目

### 关节空间轨迹规划的标准公式

对于起始关节位置$\theta_s = (\theta_{1s}, \theta_{2s})$，目标关节位置$\theta_e = (\theta_{1e}, \theta_{2e})$，存在某标度$s$，使得：

$$
\theta(s) = \theta_s+s(\theta_e-\theta_s), s\in[0,1]
$$

其中，标度$s(t)$定义了运动时间$t\in[0,T]$到归一化标量$s\in[0,1]$的映射关系。不同的$s(t)$函数，就定义了不同的轨迹规划的方法。

### 关节空间线性轨迹规划

本题目要求实现关节空间的线性(恒定速度)轨迹规划，算法步骤如下：

1. 已知起始关节位置$\theta_s = (\theta_{1s}, \theta_{2s})$，目标关节位置$\theta_e = (\theta_{1e}, \theta_{2e})$
2. 设定各关节的运动速度$v_1, v_2$，在线性运动中，该速度为常量
3. 分别求取各关节的运动距离$\Delta_1 = \theta_{1e}-\theta_{1s}, \Delta_2 = \theta_{2e}-\theta_{2s}$
4. 分别求取各关节的最小运动时间$t_1 = \frac{\Delta_1}{v_1}, t_2 = \frac{\Delta_1}{v_2}$
5. 取$t_1, t_2$中的较大者，作为标准运动时间$t_{\max} = \max(t_1, t_2)$
6. 解得标度$s(t)=\frac{t}{t_{\max}},t\in[0, t_{\max}]$
7. 代入**关节空间轨迹规划的标准公式**，可以得到任意时刻 $t$ 与对应关节位置 $\theta(t)$ 的关系：
$$
\theta(t) = \theta_s+\frac{t}{t_{\max}}(\theta_e-\theta_s), t\in[0, t_{\max}]
$$
8. 等间隔取 $t=0,~0.001,~0.002~...~t_{max}-0.001,~ t_{max}$，分别计算对应的关节位置序列$(\theta(0), ~\theta(0.001)~...~)$，该序列即为每周期向伺服下发的位置数据。